---
title: "Reverse Engineering Project"
author: "Judith Altneu"
date: "3/28/24"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

In this notebook, we are reverse engineering the story, **Inside The Political Donation History Of Wealthy Sports Owners by 538 and ESPN.**

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(janitor)
library(readr)


```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

```{r}
# Load required data
owners_donations <- read_csv('data/sports_political_donations.csv') |> clean_names()
# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 
party_donations <- owners_donations |>
  # gets rid of extra text after the main party name and puts that in a new column 
  mutate(
   new_party = case_when(
    party == 'Republican' ~ 'Republican',
    party == 'Democrat' ~ 'Democrat',
    .default = 'Bipartisan'
  )
  ) |>
  # gets rid of dollar sign and comma to make amount a number instead of a character in a new column 
  mutate(new_amount = parse_number(amount)) |>
  mutate(recipient = str_to_upper(recipient))


```

## Sentences to Engineer

In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

-   **Sentence text**: "This deep-pocketed group has sent \$34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican causes, compared to \$10.1 million (21.5 percent) to Democrats over the past three elections. Less than 6 percent of contributions went to bipartisan or unaffiliated recipients."
-   **Analysis summary**: I was able to confirm the findings from the story including both the total and the percent values. I was able to confirm the percentages of 72.9% and 21.5%. The amount of donations that went to bipartisan groups was 5.6%

```{r}
  party_donations |>
  group_by (new_party) |>
    summarise(total_amount = sum(new_amount)) |>
  arrange(desc(total_amount)) |>
    mutate(
      total_donations = sum(total_amount),
      pct_total = total_amount/ total_donations
    )
   
 

```

### Sentence 2

-   **Sentence text**: "There are 40 owners who have donated at least \$100,000 to Republican causes over the six-year period"
-   **Analysis summary**: Our analysis gave us 37 owners that had donated over \$100,000 to Republican causes and candidate over the past six years. There were three couples that donated together so there were 37 separate entries plus three spouses equals 40 separate owners who donated to Republican causes.

```{r}
 republican_party_donations <-party_donations |>
   filter(str_detect (party, "Republican")) |>
   group_by(owner) |>
   summarise(
    total_amount = sum(new_amount), 
    #total_republican_donations = n()
    ) |>
  
   filter(total_amount >= 100000) |>
   arrange(desc(total_amount))
   
          

```

### Sentence 3

-   **Sentence text**: "23 owners topping \$100,000 to Democrats [causes and candidates]"
-   **Analysis summary**: Our analysis gave us 22 sport owners that donated \$100,000 to Democratic candidates and PACs. One owner donated with their spouse creating 23 separate owners matching the number the reporters found in the story.

```{r}
  democrat_party_donations <-party_donations |>
      filter(str_detect (party, "Democrat")) |>
         group_by(owner) |>
        summarise (
        total_amount = sum(new_amount), 
       # total_democrat_donations = n()
        ) |>

         filter(total_amount >= 100000) |>
         arrange(desc(total_amount))
   

```

### Sentence 4

-   **Sentence text**: "**MLB owners have donated the most" (the table)**
-   **Analysis summary**: We were able to show in our analysis that the MLB owners have donated the most compared to owners from other leagues. One discrepancy between our analysis and the one in the story is that the amounts in each category are slightly less. This is likely due to the fact that when we cleaned up the data, we noticed that many donations were categorized as "Bipartisan but mostly (a specific party)." So, we mutated a new column to label all of those as Bipartisan for cleaner analysis. This caused our amounts to be slightly off from the story because they don't account for those donations in any specific party.

```{r}
party_donations |>
  group_by(league) |>
  summarise (
    total_democratic = sum(new_amount [new_party== 'Democrat']), 
    total_republican = sum(new_amount [new_party== 'Republican']),
    total_donations = sum(new_amount)
  ) |>
  arrange(desc(total_donations))



```

### Sentence 5

-   **Sentence text**: "Thirteen owners have contributed directly to Trumpâ€™s campaign or Trump super PACs in the 2020 election cycle, with contributions adding up to \$1,746,423."
-   **Analysis summary**: We were not able to replicate this finding. We found 12 of the 13 owners mentioned in the article that donated directly to Trump's campaign in the 2020 election cycle. We could not find Carolina Hurricanes owner Peter Karmanos' donations to Trump. When filtering through his name on the csv we did not see any recipients that had Trump in the name. We have a \$202,002 discrepancy in the total we found and the dollar figure mentioned in the story.

```{r}
party_donations |>
  filter(election_year == 2020 & (str_detect(recipient, "TRUMP"))) |>
  mutate(total_donations = sum(new_amount))
  


```

-30-
