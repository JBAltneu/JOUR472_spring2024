---
title: "Reverse Engineering Project"
author: "Student names here"
date: "Date here"
output:
  html_document:
    theme: cerulean
    highlight: pygments
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

In this notebook, we are reverse engineering the story, **Inside The Political Donation History Of Wealthy Sports Owners**

## Load libraries

Loading required libraries for this analysis.

```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(lubridate)
library(janitor)
library(readr)


```

## Load and Cleaning Data

In this section, describe the source of the data, write a basic data dictionary for data you are working with, and discuss any caveats or issues you discovered working with this data.

```{r}
# Load required data
owners_donations <- read_csv('data/sports_political_donations.csv') |> clean_names()
# Path to data should be loaded from folder "data" i.e. read_csv("data/name_of_data.csv")

# Clean required data and prepare for analysis if needed. 
party_donations <- owners_donations |>
  # gets rid of extra text after the main party name and puts that in a new column 
  mutate(
   new_party = case_when(
    party == 'Republican' ~ 'Republican',
    party == 'Democrat' ~ 'Democrat',
    .default = 'Bipartisan'
  )
  ) |>
  # gets rid of dollar sign and comma to make amount a number instead of a character in a new column 
  mutate(new_amount = parse_number(amount)) 


```

## Sentences to Engineer

In this notebook, we are reverse engineering five sentences from the story.

### Sentence 1

-   **Sentence text**: "This deep-pocketed group has sent \$34.2 million (72.9 percent) to Republican campaigns or super PACs purely supporting Republican causes, compared to \$10.1 million (21.5 percent) to Democrats over the past three elections. Less than 6 percent of contributions went to bipartisan or unaffiliated recipients."
-   **Analysis summary**: I was able to confirm the findings from the story including both the total and the percent values. The amount of donations that went to bipartisan groups was 5.6%

```{r}
# Put code to reverse engineer sentence here
# Display results of code below this codeblock
    
  total_party_donations <- party_donations |>
  group_by (new_party) |>
    summarise(total_amount = sum(new_amount)) |>
  arrange(desc(total_amount)) |>
    mutate(
      total_party_donations = sum(total_amount),
      pct_total = total_amount/ total_party_donations
    )
   
 

```

### Sentence 2

-   **Sentence text**: "There are 40 owners who have donated at least \$100,000 to Republican causes over the six-year period"
-   **Analysis summary**: We were not able to replicate this finding. Our analysis gave us 37 owners that had donated over \$100,000 to Republican causes and candidate over the past six years. Somehow the authors got three more owners than us.

```{r}
# Put code to reverse engineer sentence here
 republican_party_donations <-party_donations |>
   filter(new_party == "Republican") |>
   group_by(owner) |>
   summarise(total_amount = sum(new_amount)) |>
   filter(total_amount >= 100000) |>
   arrange(desc(total_amount))
   
          

# Display results of code below this codeblock

```

### Sentence 3

-   **Sentence text**: "23 owners topping \$100,000 to Democrats [causes and candidates]"
-   **Analysis summary**: We were not able to replicate this finding. Our analysis gave us 22 owners that had donated over \$100,000 to Democrat causes and candidates over the past six years. Somehow the authors got one more owner than us.

```{r}
# Put code to reverse engineer sentence here
  democrat_party_donations <-party_donations |>
      filter(new_party == "Democrat") |>
         group_by(owner) |>
        summarise(total_amount = sum(new_amount)) |>
         filter(total_amount >= 100000) |>
         arrange(desc(total_amount))
   
# Display results of code below this codeblock

```

```{r}
# just extra code to find something else I was curious about that was not stated in the story
party_donations |>
  group_by(team) |>
  summarise(total_amount = sum(new_amount)) |>
  arrange(desc(total_amount))
```

### Sentence 4

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

### Sentence 5

-   **Sentence text**: [Paste in sentence to engineer here]
-   **Analysis summary**: [Write up two to three sentences describing the results of your analysis. Were you able to confirm the finding? If not, why not?]

```{r}
# Put code to reverse engineer sentence here

# Display results of code below this codeblock

```

-30-
